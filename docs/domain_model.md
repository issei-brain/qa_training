# ドメインモデル
システムとDBと配送員の業務についてモデリングする。


## 業務フロー
業務フローについて説明する。

![全体業務](all_operation.drawio)

- 配送員
    - 早朝06:00にガソリン備蓄基地(以下、備蓄基地)に出勤する。
    - DBから取得した予測結果と配送ルート結果を受け取る。もしくはエラー通知を受け取る。
        - エラー通知を受け取った場合、前回の配送ルート結果を利用
            - 配送ルートは複数日分を出力するため、前回に出力した配送ルートのうち、当日に該当する結果を利用できる
            - 前回の配送ルート結果も利用できない場合は、配送員の判断で配送
    - 当日の配送ルートを確認し、目視で異常があるか確認する。
        - 異常が確認された場合、前回の配送ルート結果を利用
    - タンクローリに乗車し、__配送業務__ をする。
    - 備蓄基地に帰宅し、タンクローリにガソリンの補充をする。
        - タンクローリが満杯になるまでガソリンを補充する。
        - 18:00までに補充も含めて終了する。タンクローリのタンクに補充にかかる時間は常に1時間とする。
- ガソリンスタンド(GS)
    - 配送員によってガソリンが配送されると、タンクにガソリンを補充をする。
        - タンクは一つ。
        - 1000L
    - 営業時間終了後にその日の使用量データをDBに送信する。
        - 使用量データは1hごとに記録される。
            - 使用量はガソリンスタンドごとに異なる傾向を持つ。
            - タンクが空になると使用できない。
- システム
    - 当日の各ガソリンステーションの使用量を集計し、DB更新する。
    - DBのデータを入力とし、__予測処理__ を実行する。予測処理は、各ガソリンステーションの当日を含めた数日間について使用量の予測結果を出力する。
        - 処理が成功した場合、予測結果を配送員に送信する。
        - エラーが発生した場合、エラー通知を配送員に送信する。
    - 予測処理の後に予測結果を基に __最適化処理__ を実行する。最適化処理は、当日を含めた数日間について配送ルートを最適化し、配送ルート結果を出力する。
        - 処理が成功した場合、配送ルート結果を配送員に送信する。
        - エラーが発生した場合、エラー通知を配送員に送信する。
        - 最適化処理は6:00までに終了する。

### 予測処理
各ガソリンステーションの当日を含めた数日間について使用量の予測結果を出力する処理。

特徴量について後で記載

### 最適化処理
当日を含めた数日間について配送ルートを最適化し、配送ルート結果を出力する処理。

最適化アルゴリズムについて後で記載

### 配送業務
配送員はタンクローリに乗車し、備蓄基地から出発する。そして、配送ルートに沿って配送先のガソリンステーションにガソリンを補充する。

![配送業務](delivery_operation.drawio)

- 平均時速60km
- 補充時間は5分
- 休憩なし
- タンクローリーは一つタンクを持つ。
    - 5000L
- タンクローリーは常に満杯状態から出発する。
    - 1日に1ルート配送する。



## モデリング

![モデリング](modeling.drawio)